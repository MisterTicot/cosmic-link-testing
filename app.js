(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{144:function(t,e,n){"use strict";class i{constructor(t){return"embed"===t.mode?new i.Embed(t):new i.Full(t)}}i.Embed=n(227),i.Full=n(281),t.exports=i},189:function(t,e,n){"use strict";const{type:i}=n(16),o=n(228),r=n(231);class s extends r{constructor(t){if(super(t),this.$import(t,["automaticRedirection","authenticators","authenticatorName","showQrCode"]),this.interrupt)throw"redirect"}}const c=s.prototype;c.authenticators=o.array,c.$define("authenticator",["authenticators","authenticatorName"],(function(){return this.authenticators.find(t=>t.name===this.authenticatorName)})),c.$define("interrupt",["automaticRedirection","cosmicLink","authenticator","target"],(function(){if("string"===i(this.target))return this.cosmicLink&&this.automaticRedirection?(this.sign(),!0):void 0})),c.$on("authenticator",(function(t,e){e&&e.onExit&&e.onExit()})),t.exports=s},196:function(t,e,n){"use strict";const{View:i}=n(45),o=n(246),r=n(247),s=n(251);t.exports=class extends i{constructor(t){super('\n<section class="SigningWidget">\n  <h2>Stellar Transaction Request</h2>\n  <hr>\n\n  <section>\n    <h3>Step 1: Check the Transaction</h3>\n    %txDescription\n  </section>\n  <hr>\n\n  <section>\n    <h3>Step 2: Selection a Signing Method</h3>\n    %handlerForm\n  </section>\n  <hr>\n\n  <section>\n    <h3>Step 3: Sign the Transaction</h3>\n    %redirectionForm\n  </section>\n    '),this.txDescription=new o(t),this.handlerForm=new r(t),this.redirectionForm=new s(t)}}},227:function(t,e,n){"use strict";const{View:i}=n(45),o=n(189),r=n(196);t.exports=class extends i{constructor(t){super('\n<div class="CosmicLinkApp" %hidden>\n  <main>\n    <hr>\n    %signingWidget\n  </main>\n</div>\n    '),this.state=new o(t),this.signingWidget=new r(this.state),this.$pull("route",this.state,"query",t=>t||"")}}},228:function(t,e,n){"use strict";n(17),n(18);const i=e,o=n(229),r=n(230);i.array=[],i.byId={};class s{constructor(t){Object.assign(this,t,o[t.protocol]),this.name=t.name.replace(/ \(.*\)/,""),this.fullName=t.name,!this.buttonText&&this.redirection&&(this.buttonText="Go to "+this.name)}async handle(t){return this.handler(this,t)}}for(let t in r){const n=new s(r[t]);n.id=t,e.array.push(n),e[n.name]=n,e.byId[t]=n}},229:function(t,e,n){n(17);const i=e,o={redirection:!0,textarea:!1,qrCode:!0};function r(){return Promise.all([n.e(4),n.e(2)]).then(n.t.bind(null,284,7)).then(t=>t.default)}function s(){return n.e(5).then(n.t.bind(null,301,7)).then(t=>(t.register("https://cosmic.link","mister.ticot@cosmic.plus"),t.default))}i.cosmiclink={handler:function(t,e){return e.url+t.query}},i.ledgerwallet={buttonText:"Sign with Ledger Wallet",qrCode:!1,getAccountId:async function(){const t=await r();return await t.connect(),t.publicKey},handler:async function(t){await t.lock();const e=await r(),n=async()=>e.sign(t.transaction);return n.cosmicLink=t,n},refresh:async function(t){(await r()).onDisconnect=()=>t()},onExit:async function(){(await r()).disconnect()}},i.trezorwallet={buttonText:"Sign with Trezor Wallet",qrCode:!1,getAccountId:async function(){const t=await s();return await t.connect(),t.publicKey},handler:async function(t){await t.lock();const e=await s(),n=async()=>e.sign(t.transaction);return n.cosmicLink=t,n},refresh:async function(t){(await s()).onDisconnect=()=>t()},onExit:async function(){(await s()).disconnect()}},i.sep0007={handler:async function(t,e){await t.lock();const n=t.sep7;if("web+stellar:"!==e.url){const t=encodeURIComponent(n);return"".concat(e.url).concat(t)}return n}},i.stellarlab={handler:async function(t,e){await t.lock();const n=encodeURIComponent(t.xdr);let i="?xdr=".concat(n);if("public"===t.network||"test"===t.network)i+="&network=".concat(t.network);else{const e=encodeURIComponent(t.network),n=encodeURIComponent(t.horizon);i+="&network=custom&horizonURL=".concat(n,"&networkPassphrase=").concat(e)}return e.url+i}},i.copy={redirection:!1,textarea:!0,handler:async function(t){return await t.lock(),t.xdr}};for(let t in i)i[t]=Object.assign({},o,i[t]);i.defaults=o},230:function(t,e,n){"use strict";const i=e;i.LedgerWallet={name:"Ledger Wallet",protocol:"ledgerwallet",needSource:!0,needNetwork:!0},i.TrezorWallet={name:"Trezor Wallet",protocol:"trezorwallet",needSource:!0,needNetwork:!0},i.StellarAuthenticator={name:"Stellar Authenticator",protocol:"cosmiclink",url:"https://stellar-authenticator.org/"},i.Lobstr={name:"Lobstr Web (partial support)",protocol:"sep0007",url:"https://lobstr.co/?tx=",target:"new"},i.StellarTerm={name:"StellarTerm (partial support)",protocol:"sep0007",url:"https://stellarterm.com/?tx=",target:"new"},i.Sep7Wallet={name:"Sep-0007 Wallet",protocol:"sep0007",url:"web+stellar:",target:"external",needSource:!0,needNetwork:!0},i.StellarLaboratory={name:"Stellar Laboratory",protocol:"stellarlab",url:"https://stellar.org/laboratory/#txsigner",target:"new",needSource:!0,needNetwork:!0},i.CopyPasteXdr={name:"Copy/Paste XDR",protocol:"copy",needSource:!0,needNetwork:!0}},231:function(t,e,n){"use strict";n(17),n(18);const{CosmicLink:i,resolve:o,config:r}=n(177),s=n(195),{LiveObject:c}=n(29),{type:a}=n(16),{environment:{isEmbedded:u}}=n(1);class h extends c{constructor(t){super(),this.network="public",this.result=null,this.$import(t,["network","horizon","accountId","authenticator","query","cosmicLink"])}signUsingUri(){!u||"new"!==this.authenticator.target&&"external"!==this.authenticator.target?location.replace(this.target):(open(this.target),window.parent.postMessage("close","*"))}signUsingFunction(){this.result=this.request().then(()=>(this.cosmicLink=this.request.cosmicLink,s.forCosmicLink(this.cosmicLink))).catch(t=>t)}}const l=h.prototype;l.$on("network",(function(){const t=o.networkName(this.network);this.network===t||(this.network=t)})),l.$define("horizon",["network"],(function(){return o.horizon(this.network)||this.cosmicLink&&this.cosmicLink.tdesc.horizon||""})),l.$define("cosmicLink",["query"],(function(){return this.query&&this.query.length>1?new i(this.query):null})),l.$define("query",["cosmicLink"],(function(){return this.cosmicLink?this.cosmicLink.query:null})),l.$define("needSource",["authenticator"],(function(){if(this.authenticator)return!!this.authenticator.needSource})),l.$define("needNetwork",["authenticator"],(function(){if(this.authenticator)return!!this.authenticator.needNetwork})),l.$define("lockSource",["cosmicLink"],(function(){if(this.cosmicLink)return!!this.cosmicLink.tdesc.source})),l.$define("lockNetwork",["cosmicLink"],(function(){if(this.cosmicLink)return!!this.cosmicLink.tdesc.network})),l.$on("horizon",(function(){if(this.horizon.length>4&&"http"!==this.horizon.substr(0,4))return void(this.horizon="https://".concat(this.horizon));const t=o.networkPassphrase(this.network);r.setupNetwork(this.network,this.horizon,t)})),l.$define("accountId",["authenticator","cosmicLink"],(function(){return this.authenticator.getAccountId?this.authenticator.getAccountId():this.lockSource?this.cosmicLink.tdesc.source:"string"==typeof this.accountId?this.accountId:""})),l.$define("network",["cosmicLink"],(function(){return this.lockNetwork?this.cosmicLink.tdesc.network:this.network||"public"})),l.$define("request",["cosmicLink","authenticator","accountId","network","horizon"],(function(){if(!this.cosmicLink)return this.authenticator.url||null;if("promise"===a(this.accountId)||"error"===a(this.accountId))return new Promise(()=>{});if(this.needSource&&!this.lockSource&&!this.accountId)return new Error("Please set a source account");if(this.needNetwork){if(!this.network&&!this.lockNetwork)return new Error("Please set a network");if(!this.horizon)return new Error("Please set an Horizon address")}const t=new i(this.cosmicLink.query);return r.source=this.accountId,r.network=this.network,this.authenticator.handler(t,this.authenticator)})),l.$define("target",["request"],(function(){return"promise"===a(this.request)?new Promise(()=>{}):"error"===a(this.request)||"string"==typeof this.request?this.request:null})),l.$define("sign",["request"],(function(){return"promise"===a(this.request)?new Promise(()=>{}):"error"===a(this.request)?this.request:"string"==typeof this.request?()=>this.signUsingUri():this.request?()=>this.signUsingFunction():null})),l.$on(["cosmicLink","authenticator","network","horizon","sign"],(function(){this.result=null})),t.exports=h},246:function(t,e,n){"use strict";const{View:i}=n(45);class o extends i{constructor(t){super('\n<div class="TxDescription">%description</div>\n    '),this.$import(t,["cosmicLink"])}}o.prototype.$define("description",["cosmicLink"],(function(){return this.cosmicLink&&this.cosmicLink.tdesc.operations?this.cosmicLink.htmlDescription:"No transaction"})),t.exports=o},247:function(t,e,n){"use strict";const{View:i}=n(45),o=n(248),r=n(249),s=n(250);t.exports=class extends i{constructor(t){super('\n<form class="HandlerForm" onsubmit="return false">\n  %handlerSelector\n  <div hidden=%not:needSource>%accountInput</div>\n  <div hidden=%not:needNetwork>%networkSelector</div>\n</form>\n    '),this.$import(t,["needSource","needNetwork"]),this.handlerSelector=new r(t),this.accountInput=new o(t),this.networkSelector=new s(t)}}},248:function(t,e,n){"use strict";const{View:i}=n(45),{type:o}=n(16),{html:{copyContent:r}}=n(1);class s extends i{constructor(t){super('\n<input type="text" value=%filter:accountId %onclick %readonly %disabled\n  %placeholder autocomplete="stellar-address">\n    '),this.accountId="",this.$import(t,["cosmicLink","authenticator"]),this.$link(t,["accountId"])}onclick(){this.readonly&&r(this.domNode)}}const c=s.prototype;c.$define("disabled",["cosmicLink","authenticator"],(function(){return"promise"===o(this.accountId)||"error"===o(this.accountId)})),c.$define("readonly",["cosmicLink","authenticator"],(function(){return!!(this.cosmicLink&&this.cosmicLink.tdesc.source||this.authenticator.getAccountId)})),c.$define("placeholder",["accountId"],(function(){return"promise"===o(this.accountId)?"Connecting...":"error"===o(this.accountId)?this.accountId:"Federated Address or Public Key"})),s.helpers.filter=function(t){return"string"===o(t)?t:""},t.exports=s},249:function(t,e,n){"use strict";const{View:i,html:o}=n(45);class r extends i{constructor(t){super('\n<select class="HandlerSelector" value=%authenticatorName>\n  %toOption:...authenticators\n</select>\n    '),this.$import(t,["authenticators"]),this.$link(t,["authenticatorName"])}}r.helpers.toOption=function(t){return o("option",{value:t.name},t.fullName)},t.exports=r},250:function(t,e,n){"use strict";const{View:i}=n(45);class o extends i{constructor(t){super('\n<div class="NetworkSelector">\n\n  <div>\n    <input type="radio" $group="networkSelector" value="public"\n      disabled=%lockNetwork $label="Public">\n    <input type="radio" $group="networkSelector" value="test"\n      disabled=%lockNetwork $label="Test">\n    <input type="radio" $group="networkSelector" value="custom"\n      disabled=%lockNetwork $label="Custom">\n  </div>\n\n  <div hidden=%not:isCustom>\n    <input type="text" value=%network disabled=%lockNetwork\n      placeholder="Network Passphrase or Name">\n    <input type="text" value=%horizon\n      placeholder="Horizon URL">\n  </div>\n  \n</div>\n    '),this.$import(t,["lockNetwork"]),this.$link(t,["network","horizon"])}}const r=o.prototype;r.$define("networkSelector",["network"],(function(){return"public"===this.network||"test"===this.network?this.network:"custom"})),r.$define("isCustom",["networkSelector"],(function(){return"custom"===this.networkSelector})),r.$on("networkSelector",(function(){this.isCustom||(this.network=this.networkSelector)})),t.exports=o},251:function(t,e,n){"use strict";const{View:i,html:o}=n(45),{type:r}=n(16),s=n(252),c=n(278),a=n(279),u=n(280);class h extends i{constructor(t){super('\n<form class="RedirectionForm" hidden=%not:showButton>\n  %redirectionButton\n  <div $ref="messageBox"></div>\n  %txResultView\n</form>\n\n\n<form hidden=%not:showTextarea>\n  %xdrArea\n</form>\n\n<div hidden=%not:showQrCodeSwitcher>\n  %qrCodeSwitcher\n</div>\n    '),this.$import(t,["cosmicLink","authenticator","action","result"]),this.redirectionButton=new c(t),this.xdrArea=new u(t),this.qrCodeSwitcher=new s(t)}}const l=h.prototype;l.$define("showButton",["authenticator"],(function(){return this.authenticator.redirection})),l.$define("showTextarea",["cosmicLink","authenticator"],(function(){return this.authenticator.textarea})),l.$define("showQrCodeSwitcher",["cosmicLink","authenticator"],(function(){return this.cosmicLink&&this.authenticator.qrCode})),l.$define("txResultView",["result"],(function(){return"error"===r(this.result)?o("span",{className:"error"},this.result.message):new a(this.result)})),h.helpers.filter=function(t){return"promise"===r(t)?"Pending...":t},t.exports=h},252:function(t,e,n){"use strict";const{View:i}=n(45),{type:o}=n(16),r=n(253);class s extends i{constructor(t){super('\n<form id="qrForm">\n  <input type="button" value="QR Code" onclick=%switch %disabled>\n  <div %hidden>%canvas</div>\n</form>\n  '),this.disabled=!1,this.hidden=!0,this.target=null,this.$import(t,["target"]),this.$link(t,["showQrCode"]),this.canvas=new r(t)}switch(){this.showQrCode=!this.showQrCode}}const c=s.prototype;c.$define("disabled",["target"],(function(){return"error"===o(this.target)})),c.$define("hidden",["showQrCode","disabled"],(function(){return!this.showQrCode||this.disabled})),t.exports=s},253:function(t,e,n){"use strict";const i=n(254),{View:o}=n(45),{type:r}=n(16),{promise:{timeout:s}}=n(1);class c extends o{constructor(t){super('\n<div class="QrCodeCanvas">\n  <span class="cosmiclib_loadingAnim" hidden=%not:pending></span>\n  <canvas $ref="canvas" title=%target %hidden></canvas>\n</div>\n'),this.$import(t,["target"])}}const a=c.prototype;a.$define("pending",["target"],(function(){return"promise"===r(this.target)})),a.$define("hidden",["target"],(function(){return!this.target||"string"!==r(this.target)})),a.$on("target",(function(){var t;this.hidden?(t=this.$ref.canvas).getContext("2d").clearRect(0,0,t.width,t.height):function(t,e){s(1).then(()=>{const n=Math.max(3,6-Math.floor(Math.sqrt(e)/10));i.toCanvas(t,e,{margin:0,scale:n})})}(this.$ref.canvas,this.target)})),t.exports=c},278:function(t,e,n){"use strict";const{View:i}=n(45),{type:o}=n(16);class r extends i{constructor(t){super('\n<div class="RedirectionButton">\n  <input type="button" %value %onclick %disabled>\n  <input type="checkbox" checked=%automaticRedirection\n    $label="Automatic redirection">\n</div>\n    '),this.$import(t,["authenticator","sign","result"]),this.$link(t,["automaticRedirection"])}onclick(){this.sign()}}const s=r.prototype;s.$define("buttonText",["authenticator","sign"],(function(){return"promise"===o(this.sign)?"...":"error"===o(this.sign)?this.sign:this.sign?this.authenticator.buttonText:"No transaction"})),s.$define("value",["buttonText","result"],(function(){return"promise"===o(this.result)?"Signing...":this.result?"Done":this.buttonText})),s.$define("disabled",["sign","result"],(function(){return!this.sign||"promise"===o(this.sign)||"error"===o(this.sign)||this.result})),t.exports=r},279:function(t,e,n){"use strict";n(17);const i=n(195),{View:o,html:r}=n(45);class s extends o{static async forCosmicLink(t){const e=await i.forCosmicLink(t);return new s(e)}static fromResponse(t){const e=new i(t);return new s(e)}constructor(t){super('\n<div class="TxResultView cosmiclink_description">\n\n  <span class=%state>%title</span>\n\n  <ul class="error" hidden=%validated>\n    %{toLi:...errors}\n  </ul>\n\n</div>\n    '),this.$import(t,["title","errors","validated"]),this.state=this.validated?"info":"error"}}s.helpers.toLi=t=>r("li",[t]),t.exports=s},280:function(t,e,n){"use strict";const{View:i}=n(45),{type:o}=n(16),{html:r}=n(1);class s extends i{constructor(t){super("\n<textarea rows=3 %value %onclick %disabled %readonly %placeholder></textarea>\n    "),this.$import(t,["target"])}onclick(){this.readonly&&r(this.domNode)}}const c=s.prototype;c.$define("disabled",["target"],(function(){return!this.target||"promise"===o(this.target)||"error"===o(this.target)})),c.$define("readonly",["target"],(function(){return!!this.target})),c.$define("placeholder",["target"],(function(){return this.target?"promise"===o(this.target)?"Pending...":this.target:"No transaction"})),c.$define("value",["target"],(function(){return this.disabled?"":this.target})),t.exports=s},281:function(t,e,n){"use strict";const{sep7Utils:i}=n(177),{View:o,dom:r}=n(45),s=n(189),c=n(282),a=n(283),u=n(196),{html:{copyContent:h}}=n(1);class l extends o{constructor(t){super('\n<div class="CosmicLinkApp">\n  <header onclick=%copyHeader>\n    <h1>%location</h1><span>%query</span>\n  </header>\n\n  <img id="logo" src="icons/512x512.png" alt="">\n\n  <main>\n    %navigation\n    <hr>\n    %selectedTabView\n  </main>\n\n  <footer>\n    <a id="registerSep7Handler" onclick=%registerSep7Handler\n        hidden=%not:isSep7Supported>\n      Register as web+stellar links handler (SEP-0007)\n    </a>\n  </footer>\n\n  %antiTamper\n</div>\n'),this.selectedTabId="sign",this.state=new s(t),this.$import(this.state,["query"]),this.$import(t,["selectedTabId"]),"null"===location.origin?this.location=location.pathname:this.location="".concat(location.origin).concat(location.pathname),this.navigation=new c([{id:"sign",title:"Sign",view:new u(this.state)},{id:"about",title:"About",view:r.about}]),this.navigation.$link(this,["selectedTabView","selectedTabId"]),this.selectedTabView||(this.selectedTabId="sign"),this.isSep7Supported=i.isWebHandlerSupported(),this.antiTamper=new a(t)}copyHeader(){h(this.$ref(":scope > header"))}registerSep7Handler(){const t=location.href.split(/[?#]/,1)[0];i.registerWebHandler(t,"Cosmic.link")}}l.prototype.$define("route",["query","selectedTabId"],(function(){const t=this.selectedTabId,e="sign"===t&&this.query||"",n="sign"===t?"":"#".concat(this.selectedTabId);return"".concat(e).concat(n)})),t.exports=l},282:function(t,e,n){"use strict";const{View:i,html:o}=n(45),{LiveArray:r}=n(29);class s extends i{constructor(t=[]){super("\n<nav>%toNavigationLink:...tabs</nav>\n    "),this.tabs=r.from(t)}}s.helpers.toNavigationLink=function(t){const e=o("a",null,t.title);return e.onclick=()=>this.selectedTabId=t.id,this.$on("selectedTabId",n=>{e.className=n===t.id?"selected":""}),e},s.prototype.$define("selectedTabView",["selectedTabId"],(function(){const t=this.tabs.find(t=>t.id===this.selectedTabId);if(t)return t.view})),t.exports=s},283:function(t,e,n){"use strict";const{View:i}=n(45);class o extends i{constructor(t={}){super('<img class="AntiTamper" %src>'),this.$import(t,["baseUrl","set","antiTamperHash"])}}const r=o.prototype;r.baseUrl="https://robohash.org",r.set="set1",r.$define("src",["baseURl","set","antiTamperHash"],(function(){return"".concat(this.baseUrl,"/").concat(this.antiTamperHash,"?set=").concat(this.set)})),o.makeHash=function(t=32){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let n="";for(let i=0;i<t;i++){const t=Math.floor(Math.random()*e.length);n+=e.charAt(t)}return n},t.exports=o}}]);
//# sourceMappingURL=app.js.map