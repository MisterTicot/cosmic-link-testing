{"version":3,"sources":["webpack:///./src/app.js","webpack:///./src/helpers.js","webpack:///./src/tamper.js","webpack:///./src/signing-ui.js"],"names":["cosmicLib","require","dom","html","Page","the","copyContent","contextIsWidget","location","origin","websiteUrl","textContent","pathname","query","search","header","onclick","sep7Utils","isWebHandlerSupported","show","registerSep7Handler","registerWebHandler","href","split","signingUI","signingPage","add","sign","onSelect","history","replaceState","refresh","init","help","current","select","helpers","exports","enableButton","button","value","disabled","disableButton","readWriteBox","box","placeholder","readOnly","undefined","style","cursor","readOnlyBox","disableBox","display","element","type","message","classname","messageNode","create","rewrite","showIf","flag","hide","switchPage","from","to","append","body","main","document","activeElement","prevNode","grab","destroy","copiedNode","parentNode","insertBefore","setTimeout","hidden","tamper","src","localStorage","myHash","alphabet","hash","i","charAt","Math","floor","random","length","CosmicLink","env","QrCode","timeout","authenticators","key","cosmiclink_description","nodes","forEach","entry","authenticator","name","redirect","redirectionCheckbox","checked","qrCode","qrCodeUI","enable","substr","id","passphrase","resolve","networkPassphrase","config","setupNetwork","cosmicLink","tdesc","authenticatorUI","redirectionUI","transactionUI","needSource","accountId","needNetwork","customNetwork","horizon","network","source","saveTransaction","transaction","handle","then","error","status","getAccountId","accountMsgbox","accountUI","disable","networkUI","accountDiv","accountIdBox","console","networkDiv","customNetworkSetup","networkSelector","publicNetwork","scrollLeft","testNetwork","onscroll","customPassphrase","customHorizon","lock","selector","onchange","onExit","textOverflow","networkName","redirection","redirectionForm","textarea","textareaForm","qrForm","redirectionButton","xdrBox","loadingAnim","url","buttonText","click","clear","isEmbedded","target","open","window","parent","postMessage","replace","redirectionMsgbox","sendTransaction","response","send","referrer","back","canvas","toCanvas","margin","scale","title","QR","qrButton","className"],"mappings":"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","file":"app.js","sourcesContent":["\"use_strict\"\n/**\n * Cosmic.Link Graphical User Interface\n */\nconst cosmicLib = require(\"cosmic-lib\")\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst Page = require(\"@cosmic-plus/domutils/es5/page\")\n\nconst the = require(\"./shared\")\nconst { copyContent } = require(\"./helpers\")\n\nif (!the.contextIsWidget) {\n  // Header\n  if (location.origin === \"null\") dom.websiteUrl.textContent = location.pathname\n  else dom.websiteUrl.textContent = location.origin + location.pathname\n  dom.query.textContent = location.search\n  dom.header.onclick = () => copyContent(dom.header)\n\n  // Robot tamper\n  require(\"./tamper\")\n\n  // SEP-0007\n  if (cosmicLib.sep7Utils.isWebHandlerSupported()) {\n    html.show(dom.registerSep7Handler)\n    dom.registerSep7Handler.onclick = () => {\n      cosmicLib.sep7Utils.registerWebHandler(\n        location.href.split(/[?#]/, 1)[0],\n        \"Cosmic.link\"\n      )\n    }\n  }\n}\n\n// Signing interface\nconst signingUI = require(\"./signing-ui\")\nconst signingPage = Page.add(\"Sign\", dom.sign)\nsigningPage.onSelect = function () {\n  history.replaceState(\"\", null, location.pathname + location.search)\n  signingUI.refresh()\n}\n\nsigningUI.init()\n\n// About page\nif (!the.contextIsWidget) Page.add(\"Help\", dom.help)\n\n// Default page\nif (Page.current === signingPage) signingPage.onSelect()\nelse if (!Page.current) Page.select(\"#sign\")\n","\"use_strict\"\n/**\n * Generic helpers\n */\nconst helpers = exports\n\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\n\n/*******************************************************************************\n * Form Elements Helpers\n */\n\nhelpers.enableButton = function (button, value, onclick) {\n  if (typeof value === \"string\") button.value = value\n  button.onclick = onclick\n  button.disabled = false\n}\n\nhelpers.disableButton = function (button, value) {\n  if (typeof value === \"string\") button.value = value\n  button.disabled = true\n}\n\nhelpers.readWriteBox = function (box, placeholder, value) {\n  if (typeof value === \"string\") box.value = value\n  if (typeof placeholder === \"string\") box.placeholder = placeholder\n  box.disabled = false\n  box.readOnly = false\n  box.onclick = undefined\n  box.style.cursor = \"initial\"\n}\n\nhelpers.readOnlyBox = function (box, value) {\n  if (typeof value === \"string\") box.value = value\n  box.disabled = false\n  box.readOnly = true\n  box.onclick = () => helpers.copyContent(box)\n  box.style.cursor = \"pointer\"\n}\n\nhelpers.disableBox = function (box, placeholder) {\n  helpers.readWriteBox(box, placeholder, \"\")\n  box.disabled = true\n}\n\n/*******************************************************************************\n * Other Helpers\n */\n\nhelpers.display = function (element, type = \"\", message = \"\") {\n  const classname = type ? \".\" + type : null\n  const messageNode = classname\n    ? html.create(\"span\", classname, message)\n    : message\n  html.rewrite(element, html.create(\"span\", classname, messageNode))\n}\n\nhelpers.showIf = function (flag, element) {\n  flag ? html.show(element) : html.hide(element)\n}\n\nhelpers.switchPage = function (from, to) {\n  html.append(dom.body, from)\n  html.append(dom.main, to)\n}\n\nhelpers.copyContent = function (element) {\n  if (html.copyContent(element) && document.activeElement.value) {\n    const prevNode = html.grab(\"#copied\")\n    if (prevNode) html.destroy(prevNode)\n    const copiedNode = html.create(\"span\", \"#copied\", \"Copied\")\n    element.parentNode.insertBefore(copiedNode, element)\n    setTimeout(() => {\n      copiedNode.hidden = true\n    }, 3000)\n  }\n}\n","\"use_strict\"\n/**\n * Robot tamper.\n */\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\n\nfunction myHash () {\n  if (localStorage.myHash) return localStorage.myHash\n\n  var alphabet =\n    \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n  var size = 32\n\n  var hash = \"\"\n  for (var i = 0; i < size; i++) {\n    hash += alphabet.charAt(Math.floor(Math.random() * alphabet.length))\n  }\n\n  localStorage.myHash = hash\n  return hash\n}\n\ndom.tamper.src = \"https://robohash.org/\" + myHash()\n","\"use_strict\"\nconst main = exports\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst CosmicLink = cosmicLib.CosmicLink\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst env = require(\"@cosmic-plus/jsutils/es5/env\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst QrCode = require(\"qrcode\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst authenticators = require(\"./authenticators\")\nconst the = require(\"./shared\")\n\nconst {\n  enableButton,\n  disableButton,\n  readWriteBox,\n  readOnlyBox,\n  disableBox,\n  display,\n  showIf\n} = require(\"./helpers\")\n\n// Run once page is fully loaded\nmain.init = function () {\n  // Step 1: Transaction\n  if (!the.query) html.rewrite(dom.cosmiclink_description, \"No transaction\")\n\n  // Step 2: Authenticator\n  authenticators.nodes.forEach(entry => html.append(dom.authenticators, entry))\n  dom.authenticators.value = the.authenticator.name\n\n  // Step 3: Signing\n  if (the.redirect) dom.redirectionCheckbox.checked = true\n  if (the.qrCode) qrCodeUI.enable()\n\n  // CosmicLib network setup\n  for (let key in localStorage) {\n    if (key.substr(0, 8) === \"network:\") {\n      const id = key.substr(8)\n      const passphrase = cosmicLib.resolve.networkPassphrase(id)\n      cosmicLib.config.setupNetwork(id, localStorage[key], passphrase)\n    }\n  }\n}\n\nmain.refresh = async function () {\n  if (the.query) the.cosmicLink = new CosmicLink(the.query)\n  else the.cosmicLink = { tdesc: {} }\n  authenticatorUI.init()\n  redirectionUI.init()\n  if (the.cosmicLink.query) transactionUI.refresh()\n}\n\n/*******************************************************************************\n * Step 1: Transaction UI\n */\n\nconst transactionUI = {}\n\ntransactionUI.refresh = function () {\n  if (the.authenticator.needSource && !the.accountId) {\n    if (!the.authenticator.getAccountId) {\n      redirectionUI.error(\"Please set a source account\")\n    }\n    return\n  }\n  if (the.authenticator.needNetwork) {\n    if (dom.customNetwork.checked && (!the.horizon || !the.network)) {\n      redirectionUI.error(\"Please fill custom network fields\")\n      return\n    }\n  }\n\n  cosmicLib.config.source = the.accountId\n  cosmicLib.config.network = the.network\n\n  const saveTransaction = the.transaction = the.authenticator.handle(\n    the.cosmicLink\n  )\n\n  the.transaction\n    .then(function (value) {\n      if (the.transaction === saveTransaction) redirectionUI.refresh(value)\n    })\n    .catch(function () {\n      if (the.transaction === saveTransaction)\n        redirectionUI.error(the.cosmicLink.status)\n    })\n}\n\n/*******************************************************************************\n * Step 2: Authenticator UI\n */\n\nconst authenticatorUI = {}\n\nauthenticatorUI.init = function () {\n  display(dom.accountMsgbox, \"\")\n  the.authenticator = authenticators[dom.authenticators.value]\n  localStorage.authenticator = the.authenticator.name\n\n  if (the.authenticator.needSource) accountUI.init()\n  else accountUI.disable()\n  if (the.authenticator.needNetwork) networkUI.init()\n  else networkUI.disable()\n\n  if (the.authenticator.refresh) the.authenticator.refresh(main.refresh)\n}\n\n/**\n * AccountID box UI\n */\nconst accountUI = {}\n\naccountUI.disable = function () {\n  html.hide(dom.accountDiv)\n  the.accountId = undefined\n}\n\naccountUI.init = async function () {\n  html.show(dom.accountDiv)\n\n  if (!the.authenticator.getAccountId) {\n    if (the.cosmicLink.tdesc.source) {\n      if (the.cosmicLink.tdesc.source.error) {\n        disableBox(dom.accountIdBox, the.cosmicLink.tdesc.source.error.message)\n      } else {\n        the.accountId = true\n        readOnlyBox(dom.accountIdBox, the.cosmicLink.tdesc.source)\n      }\n    } else {\n      the.accountId = localStorage.accountId\n      readWriteBox(\n        dom.accountIdBox,\n        \"Your Account Address or ID\",\n        the.accountId\n      )\n    }\n  } else {\n    the.accountId = undefined\n    disableBox(dom.accountIdBox, \"Connecting...\")\n\n    const authenticator = the.authenticator\n    try {\n      const accountId = await the.authenticator.getAccountId()\n      if (the.authenticator !== authenticator) return\n      the.accountId = accountId\n      readOnlyBox(dom.accountIdBox, accountId)\n      transactionUI.refresh()\n    } catch (error) {\n      if (the.authenticator !== authenticator) return\n      dom.accountIdBox.placeholder = \"Error\"\n      display(dom.accountMsgbox, \"error\", error.message + \".\")\n      console.error(error)\n    }\n  }\n}\n\n/**\n * Network selection UI\n */\nconst networkUI = {}\n\nnetworkUI.disable = function () {\n  html.hide(dom.networkDiv)\n  the.network = \"public\"\n  the.horizon = undefined\n}\n\nnetworkUI.init = function () {\n  html.show(dom.networkDiv)\n  html.hide(dom.customNetworkSetup)\n  the.network = the.cosmicLink.tdesc.network || localStorage.networkSelector\n  the.horizon = undefined\n\n  switch (the.network) {\n  case undefined:\n  case \"public\":\n    dom.publicNetwork.checked = true\n    dom.networkSelector.scrollLeft = 0\n    break\n  case \"test\":\n    dom.testNetwork.checked = true\n    break\n  default:\n    if (dom.networkSelector.onscroll) dom.networkSelector.onscroll()\n    // Doesn't works when called synchronously.\n    timeout(1).then(() => dom.networkSelector.scrollLeft = 999)\n    dom.customNetwork.checked = true\n\n    html.show(dom.customNetworkSetup)\n    if (!the.network) the.network = localStorage.customPassphrase\n    the.horizon =\n        cosmicLib.resolve.horizon(the.network || \"\")\n        || the.cosmicLink.tdesc.horizon\n    dom.customPassphrase.value = the.network || \"\"\n    dom.customHorizon.value = the.horizon || \"\"\n  }\n\n  if (the.cosmicLink.tdesc.network) networkUI.lock()\n}\n\nnetworkUI.lock = function () {\n  readOnlyBox(dom.customPassphrase)\n  dom.publicNetwork.disabled = true\n  dom.testNetwork.disabled = true\n  dom.customNetwork.disabled = true\n}\n\nnetworkUI.switch = function (selector) {\n  localStorage.networkSelector = selector\n  main.refresh()\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.authenticators.onchange = function () {\n  if (the.authenticator && the.authenticator.onExit) the.authenticator.onExit()\n  the.redirect = localStorage.redirect = false\n  dom.redirectionCheckbox.checked = false\n  main.refresh()\n}\n\ndom.accountIdBox.onchange = function () {\n  the.accountId = localStorage.accountId = dom.accountIdBox.value\n  main.refresh()\n}\n\ndom.networkSelector.onscroll = function () {\n  dom.networkSelector.style.textOverflow = \"initial\"\n  dom.networkSelector.onscroll = undefined\n}\n\ndom.publicNetwork.onchange = () => networkUI.switch(\"public\")\ndom.testNetwork.onchange = () => networkUI.switch(\"test\")\ndom.customNetwork.onchange = () => networkUI.switch(\"\")\n\ndom.customPassphrase.onchange = function () {\n  const networkName = cosmicLib.resolve.networkName(dom.customPassphrase.value)\n  localStorage.customPassphrase = networkName\n  networkUI.switch(\"\")\n}\n\ndom.customHorizon.onchange = function () {\n  the.horizon = dom.customHorizon.value\n  if (the.horizon && the.horizon.substr(0, 4) !== \"http\") {\n    the.horizon = \"https://\" + the.horizon\n  }\n  if (the.network && the.horizon) {\n    const passphrase = cosmicLib.resolve.networkPassphrase(the.network)\n    cosmicLib.config.setupNetwork(the.network, the.horizon, passphrase)\n    localStorage[\"network:\" + passphrase] = the.horizon\n  }\n  if (the.network) main.refresh()\n}\n\n/*******************************************************************************\n * Step 3: Signing/Redirection UI\n */\n\nconst redirectionUI = {}\n\nredirectionUI.init = function () {\n  redirectionUI.display(\"\")\n  showIf(the.authenticator.redirection, dom.redirectionForm)\n  showIf(the.authenticator.textarea, dom.textareaForm)\n  showIf(the.query && the.authenticator.qrCode, dom.qrForm)\n\n  if (!the.query) {\n    if (the.authenticator.url) {\n      const onclick = () => location.href = the.authenticator.url\n      enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n    } else {\n      redirectionUI.error(\"No transaction\")\n    }\n  } else {\n    if (the.authenticator.redirection) disableButton(dom.redirectionButton, \"…\")\n    if (the.authenticator.textarea) disableBox(dom.xdrBox, \"Computing...\")\n    if (the.authenticator.qrCode) qrCodeUI.loadingAnim()\n  }\n}\n\nredirectionUI.refresh = function (value) {\n  if (the.authenticator.redirection) {\n    const onclick = () => redirectionUI.click(value)\n    enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n  }\n\n  if (the.redirect && !the.contextIsWidget) {\n    dom.redirectionButton.onclick()\n  }\n\n  if (the.authenticator.textarea) readOnlyBox(dom.xdrBox, value)\n  if (the.authenticator.qrCode) qrCodeUI.refresh(value)\n}\n\nredirectionUI.error = function (error) {\n  disableButton(dom.redirectionButton, error)\n  disableBox(dom.xdrBox, error)\n  html.clear(dom.qrCode)\n}\n\nredirectionUI.click = async function (value) {\n  if (typeof value === \"string\") {\n    if (\n      the.contextIsWidget\n      || env.isEmbedded && the.authenticator.target === \"new\"\n    ) {\n      open(value, \"_blank\")\n      window.parent.postMessage(\"close\", \"*\")\n    } else if (env.isEmbedded && the.authenticator.target === \"external\") {\n      open(value)\n      window.parent.postMessage(\"close\", \"*\")\n    } else {\n      location.replace(value)\n    }\n  } else if (typeof value === \"function\") {\n    display(dom.redirectionMsgbox, \"info\", \"Waiting for confirmation...\")\n    dom.redirectionButton.disabled = true\n\n    try {\n      const transaction = await value()\n      await redirectionUI.sendTransaction(transaction)\n    } catch (error) {\n      console.error(error.response || error)\n      redirectionUI.display(\"error\", error.message.replace(/\\.$/, \"\"))\n      dom.redirectionButton.disabled = false\n    }\n  }\n}\n\nredirectionUI.sendTransaction = async function () {\n  redirectionUI.display(\"info\", \"Sending to the network...\")\n  history.replaceState({}, \"\", the.cosmicLink.query)\n  dom.query.textContent = the.cosmicLink.query\n  networkUI.lock()\n\n  await the.cosmicLink.send()\n  redirectionUI.display(\"info\", \"Transaction validated\")\n  if (env.isEmbedded) parent.postMessage(\"close\", \"*\")\n  if (document.referrer) {\n    enableButton(dom.redirectionButton, \"Close\", () => history.back())\n  } else {\n    dom.redirectionButton.value = \"Done\"\n  }\n}\n\nredirectionUI.display = function (type, message) {\n  display(dom.redirectionMsgbox, type, message)\n}\n\nconst qrCodeUI = {}\n\nqrCodeUI.loadingAnim = function () {\n  html.rewrite(dom.qrCode, html.create(\"canvas\", \".cosmiclib_loadingAnim\"))\n}\n\nqrCodeUI.refresh = function (value) {\n  if (!the.authenticator.qrCode || !value) return\n\n  const canvas = html.create(\"canvas\")\n  QrCode.toCanvas(canvas, value, { margin: 0, scale: 4 })\n  canvas.title = value\n  html.rewrite(dom.qrCode, canvas)\n}\n\nqrCodeUI.switch = function () {\n  the.qrCode = localStorage.QR = !the.qrCode\n  if (the.qrCode) qrCodeUI.enable()\n  else qrCodeUI.disable()\n}\n\nqrCodeUI.enable = function () {\n  dom.qrButton.className = \"enabled\"\n  html.show(dom.qrCode)\n}\n\nqrCodeUI.disable = function () {\n  dom.qrButton.className = undefined\n  html.hide(dom.qrCode)\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.redirectionButton.onclick = redirectionUI.click\ndom.qrButton.onclick = qrCodeUI.switch\n\ndom.redirectionCheckbox.onchange = function () {\n  the.redirect = localStorage.redirect = !the.redirect\n}\n"],"sourceRoot":""}