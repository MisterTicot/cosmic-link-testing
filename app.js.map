{"version":3,"sources":["webpack:///./src/tamper.js","webpack:///./src/signing-ui.js","webpack:///./src/app.js","webpack:///./src/helpers.js"],"names":["require","tamper","src","localStorage","myHash","alphabet","hash","i","charAt","Math","floor","random","length","main","exports","cosmicLib","CosmicLink","dom","env","html","QrCode","timeout","authenticators","the","enableButton","disableButton","readWriteBox","readOnlyBox","disableBox","display","showIf","init","key","query","rewrite","cosmiclink_description","nodes","forEach","entry","append","value","authenticator","name","redirect","redirectionCheckbox","checked","qrCode","qrCodeUI","enable","substr","id","passphrase","resolve","networkPassphrase","config","setupNetwork","refresh","cosmicLink","tdesc","authenticatorUI","redirectionUI","transactionUI","needSource","accountId","needNetwork","customNetwork","horizon","network","source","saveTransaction","transaction","handle","then","error","status","getAccountId","accountMsgbox","accountUI","disable","networkUI","hide","accountDiv","undefined","show","accountIdBox","message","placeholder","console","networkDiv","customNetworkSetup","networkSelector","publicNetwork","scrollLeft","testNetwork","onscroll","customPassphrase","customHorizon","lock","disabled","selector","onchange","onExit","style","textOverflow","networkName","redirection","redirectionForm","textarea","textareaForm","qrForm","redirectionButton","xdrBox","loadingAnim","url","buttonText","location","href","click","contextIsWidget","onclick","clear","isEmbedded","target","open","window","parent","postMessage","replace","redirectionMsgbox","sendTransaction","response","JSON","stringify","data","extras","result_codes","history","replaceState","textContent","send","document","referrer","back","type","create","canvas","toCanvas","margin","scale","title","QR","qrButton","className","Page","copyContent","origin","websiteUrl","pathname","search","header","sep7Utils","isWebHandlerSupported","registerSep7Handler","registerWebHandler","split","signingUI","signingPage","add","sign","onSelect","help","current","select","helpers","button","box","readOnly","cursor","element","classname","messageNode","flag","switchPage","from","to","body","activeElement","prevNode","grab","destroy","copiedNode","parentNode","insertBefore","setTimeout","hidden"],"mappings":"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","file":"app.js","sourcesContent":["\"use_strict\"\n/**\n * Robot tamper.\n */\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\n\nfunction myHash () {\n  if (localStorage.myHash) return localStorage.myHash\n\n  var alphabet =\n    \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n  var size = 32\n\n  var hash = \"\"\n  for (var i = 0; i < size; i++) {\n    hash += alphabet.charAt(Math.floor(Math.random() * alphabet.length))\n  }\n\n  localStorage.myHash = hash\n  return hash\n}\n\ndom.tamper.src = \"https://robohash.org/\" + myHash()\n","\"use_strict\"\nconst main = exports\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst CosmicLink = cosmicLib.CosmicLink\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst env = require(\"@cosmic-plus/jsutils/es5/env\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst QrCode = require(\"qrcode\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst authenticators = require(\"./authenticators\")\nconst the = require(\"./shared\")\n\nconst {\n  enableButton,\n  disableButton,\n  readWriteBox,\n  readOnlyBox,\n  disableBox,\n  display,\n  showIf\n} = require(\"./helpers\")\n\n// Run once page is fully loaded\nmain.init = function () {\n  // Step 1: Transaction\n  if (!the.query) html.rewrite(dom.cosmiclink_description, \"No transaction\")\n\n  // Step 2: Authenticator\n  authenticators.nodes.forEach(entry => html.append(dom.authenticators, entry))\n  dom.authenticators.value = the.authenticator.name\n\n  // Step 3: Signing\n  if (the.redirect) dom.redirectionCheckbox.checked = true\n  if (the.qrCode) qrCodeUI.enable()\n\n  // CosmicLib network setup\n  for (let key in localStorage) {\n    if (key.substr(0, 8) === \"network:\") {\n      const id = key.substr(8)\n      const passphrase = cosmicLib.resolve.networkPassphrase(id)\n      cosmicLib.config.setupNetwork(id, localStorage[key], passphrase)\n    }\n  }\n}\n\nmain.refresh = async function () {\n  if (the.query) the.cosmicLink = new CosmicLink(the.query)\n  else the.cosmicLink = { tdesc: {} }\n  authenticatorUI.init()\n  redirectionUI.init()\n  if (the.cosmicLink.query) transactionUI.refresh()\n}\n\n/*******************************************************************************\n * Step 1: Transaction UI\n */\n\nconst transactionUI = {}\n\ntransactionUI.refresh = function () {\n  if (the.authenticator.needSource && !the.accountId) {\n    if (!the.authenticator.getAccountId) {\n      redirectionUI.error(\"Please set a source account\")\n    }\n    return\n  }\n  if (the.authenticator.needNetwork) {\n    if (dom.customNetwork.checked && (!the.horizon || !the.network)) {\n      redirectionUI.error(\"Please fill custom network fields\")\n      return\n    }\n  }\n\n  cosmicLib.config.source = the.accountId\n  cosmicLib.config.network = the.network\n\n  const saveTransaction = the.transaction = the.authenticator.handle(\n    the.cosmicLink\n  )\n\n  the.transaction\n    .then(function (value) {\n      if (the.transaction === saveTransaction) redirectionUI.refresh(value)\n    })\n    .catch(function () {\n      if (the.transaction === saveTransaction)\n        redirectionUI.error(the.cosmicLink.status)\n    })\n}\n\n/*******************************************************************************\n * Step 2: Authenticator UI\n */\n\nconst authenticatorUI = {}\n\nauthenticatorUI.init = function () {\n  display(dom.accountMsgbox, \"\")\n  the.authenticator = authenticators[dom.authenticators.value]\n  localStorage.authenticator = the.authenticator.name\n\n  if (the.authenticator.needSource) accountUI.init()\n  else accountUI.disable()\n  if (the.authenticator.needNetwork) networkUI.init()\n  else networkUI.disable()\n\n  if (the.authenticator.refresh) the.authenticator.refresh(main.refresh)\n}\n\n/**\n * AccountID box UI\n */\nconst accountUI = {}\n\naccountUI.disable = function () {\n  html.hide(dom.accountDiv)\n  the.accountId = undefined\n}\n\naccountUI.init = async function () {\n  html.show(dom.accountDiv)\n\n  if (!the.authenticator.getAccountId) {\n    if (the.cosmicLink.tdesc.source) {\n      if (the.cosmicLink.tdesc.source.error) {\n        disableBox(dom.accountIdBox, the.cosmicLink.tdesc.source.error.message)\n      } else {\n        the.accountId = true\n        readOnlyBox(dom.accountIdBox, the.cosmicLink.tdesc.source)\n      }\n    } else {\n      the.accountId = localStorage.accountId\n      readWriteBox(\n        dom.accountIdBox,\n        \"Your Account Address or ID\",\n        the.accountId\n      )\n    }\n  } else {\n    the.accountId = undefined\n    disableBox(dom.accountIdBox, \"Connecting...\")\n\n    const authenticator = the.authenticator\n    try {\n      const accountId = await the.authenticator.getAccountId()\n      if (the.authenticator !== authenticator) return\n      the.accountId = accountId\n      readOnlyBox(dom.accountIdBox, accountId)\n      transactionUI.refresh()\n    } catch (error) {\n      if (the.authenticator !== authenticator) return\n      dom.accountIdBox.placeholder = \"Error\"\n      display(dom.accountMsgbox, \"error\", error.message + \".\")\n      console.error(error)\n    }\n  }\n}\n\n/**\n * Network selection UI\n */\nconst networkUI = {}\n\nnetworkUI.disable = function () {\n  html.hide(dom.networkDiv)\n  the.network = \"public\"\n  the.horizon = undefined\n}\n\nnetworkUI.init = function () {\n  html.show(dom.networkDiv)\n  html.hide(dom.customNetworkSetup)\n  the.network = the.cosmicLink.tdesc.network || localStorage.networkSelector\n  the.horizon = undefined\n\n  switch (the.network) {\n  case undefined:\n  case \"public\":\n    dom.publicNetwork.checked = true\n    dom.networkSelector.scrollLeft = 0\n    break\n  case \"test\":\n    dom.testNetwork.checked = true\n    break\n  default:\n    if (dom.networkSelector.onscroll) dom.networkSelector.onscroll()\n    // Doesn't works when called synchronously.\n    timeout(1).then(() => dom.networkSelector.scrollLeft = 999)\n    dom.customNetwork.checked = true\n\n    html.show(dom.customNetworkSetup)\n    if (!the.network) the.network = localStorage.customPassphrase\n    the.horizon =\n        cosmicLib.resolve.horizon(the.network || \"\")\n        || the.cosmicLink.tdesc.horizon\n    dom.customPassphrase.value = the.network || \"\"\n    dom.customHorizon.value = the.horizon || \"\"\n  }\n\n  if (the.cosmicLink.tdesc.network) networkUI.lock()\n}\n\nnetworkUI.lock = function () {\n  readOnlyBox(dom.customPassphrase)\n  dom.publicNetwork.disabled = true\n  dom.testNetwork.disabled = true\n  dom.customNetwork.disabled = true\n}\n\nnetworkUI.switch = function (selector) {\n  localStorage.networkSelector = selector\n  main.refresh()\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.authenticators.onchange = function () {\n  if (the.authenticator && the.authenticator.onExit) the.authenticator.onExit()\n  the.redirect = localStorage.redirect = false\n  dom.redirectionCheckbox.checked = false\n  main.refresh()\n}\n\ndom.accountIdBox.onchange = function () {\n  the.accountId = localStorage.accountId = dom.accountIdBox.value\n  main.refresh()\n}\n\ndom.networkSelector.onscroll = function () {\n  dom.networkSelector.style.textOverflow = \"initial\"\n  dom.networkSelector.onscroll = undefined\n}\n\ndom.publicNetwork.onchange = () => networkUI.switch(\"public\")\ndom.testNetwork.onchange = () => networkUI.switch(\"test\")\ndom.customNetwork.onchange = () => networkUI.switch(\"\")\n\ndom.customPassphrase.onchange = function () {\n  const networkName = cosmicLib.resolve.networkName(dom.customPassphrase.value)\n  localStorage.customPassphrase = networkName\n  networkUI.switch(\"\")\n}\n\ndom.customHorizon.onchange = function () {\n  the.horizon = dom.customHorizon.value\n  if (the.horizon && the.horizon.substr(0, 4) !== \"http\") {\n    the.horizon = \"https://\" + the.horizon\n  }\n  if (the.network && the.horizon) {\n    const passphrase = cosmicLib.resolve.networkPassphrase(the.network)\n    cosmicLib.config.setupNetwork(the.network, the.horizon, passphrase)\n    localStorage[\"network:\" + passphrase] = the.horizon\n  }\n  if (the.network) main.refresh()\n}\n\n/*******************************************************************************\n * Step 3: Signing/Redirection UI\n */\n\nconst redirectionUI = {}\n\nredirectionUI.init = function () {\n  redirectionUI.display(\"\")\n  showIf(the.authenticator.redirection, dom.redirectionForm)\n  showIf(the.authenticator.textarea, dom.textareaForm)\n  showIf(the.query && the.authenticator.qrCode, dom.qrForm)\n\n  if (!the.query) {\n    if (the.authenticator.url) {\n      const onclick = () => location.href = the.authenticator.url\n      enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n    } else {\n      redirectionUI.error(\"No transaction\")\n    }\n  } else {\n    if (the.authenticator.redirection) disableButton(dom.redirectionButton, \"…\")\n    if (the.authenticator.textarea) disableBox(dom.xdrBox, \"Computing...\")\n    if (the.authenticator.qrCode) qrCodeUI.loadingAnim()\n  }\n}\n\nredirectionUI.refresh = function (value) {\n  if (the.authenticator.redirection) {\n    const onclick = () => redirectionUI.click(value)\n    enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n  }\n\n  if (the.redirect && !the.contextIsWidget) {\n    dom.redirectionButton.onclick()\n  }\n\n  if (the.authenticator.textarea) readOnlyBox(dom.xdrBox, value)\n  if (the.authenticator.qrCode) qrCodeUI.refresh(value)\n}\n\nredirectionUI.error = function (error) {\n  disableButton(dom.redirectionButton, error)\n  disableBox(dom.xdrBox, error)\n  html.clear(dom.qrCode)\n}\n\nredirectionUI.click = async function (value) {\n  if (typeof value === \"string\") {\n    if (\n      the.contextIsWidget\n      || env.isEmbedded && the.authenticator.target === \"new\"\n    ) {\n      open(value, \"_blank\")\n      window.parent.postMessage(\"close\", \"*\")\n    } else if (env.isEmbedded && the.authenticator.target === \"external\") {\n      open(value)\n      window.parent.postMessage(\"close\", \"*\")\n    } else {\n      location.replace(value)\n    }\n  } else if (typeof value === \"function\") {\n    display(dom.redirectionMsgbox, \"info\", \"Waiting for confirmation...\")\n    dom.redirectionButton.disabled = true\n\n    try {\n      const transaction = await value()\n      await redirectionUI.sendTransaction(transaction)\n    } catch (error) {\n      console.error(error.response || error)\n      let message = error.message.replace(/\\.$/, \"\") + \"\\n\"\n      if (error.response) {\n        message += JSON.stringify(error.response.data.extras.result_codes)\n      }\n      redirectionUI.display(\"error\", message)\n      dom.redirectionButton.disabled = false\n    }\n  }\n}\n\nredirectionUI.sendTransaction = async function () {\n  redirectionUI.display(\"info\", \"Sending to the network...\")\n  history.replaceState({}, \"\", the.cosmicLink.query)\n  dom.query.textContent = the.cosmicLink.query\n  networkUI.lock()\n\n  await the.cosmicLink.send()\n  redirectionUI.display(\"info\", \"Transaction validated\")\n  if (env.isEmbedded) parent.postMessage(\"close\", \"*\")\n  if (document.referrer) {\n    enableButton(dom.redirectionButton, \"Close\", () => history.back())\n  } else {\n    dom.redirectionButton.value = \"Done\"\n  }\n}\n\nredirectionUI.display = function (type, message) {\n  display(dom.redirectionMsgbox, type, message)\n}\n\nconst qrCodeUI = {}\n\nqrCodeUI.loadingAnim = function () {\n  html.rewrite(dom.qrCode, html.create(\"canvas\", \".cosmiclib_loadingAnim\"))\n}\n\nqrCodeUI.refresh = function (value) {\n  if (!the.authenticator.qrCode || !value) return\n\n  const canvas = html.create(\"canvas\")\n  QrCode.toCanvas(canvas, value, { margin: 0, scale: 4 })\n  canvas.title = value\n  html.rewrite(dom.qrCode, canvas)\n}\n\nqrCodeUI.switch = function () {\n  the.qrCode = localStorage.QR = !the.qrCode\n  if (the.qrCode) qrCodeUI.enable()\n  else qrCodeUI.disable()\n}\n\nqrCodeUI.enable = function () {\n  dom.qrButton.className = \"enabled\"\n  html.show(dom.qrCode)\n}\n\nqrCodeUI.disable = function () {\n  dom.qrButton.className = undefined\n  html.hide(dom.qrCode)\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.redirectionButton.onclick = redirectionUI.click\ndom.qrButton.onclick = qrCodeUI.switch\n\ndom.redirectionCheckbox.onchange = function () {\n  the.redirect = localStorage.redirect = !the.redirect\n}\n","\"use_strict\"\n/**\n * Cosmic.Link Graphical User Interface\n */\nconst cosmicLib = require(\"cosmic-lib\")\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst Page = require(\"@cosmic-plus/domutils/es5/page\")\n\nconst the = require(\"./shared\")\nconst { copyContent } = require(\"./helpers\")\n\nif (!the.contextIsWidget) {\n  // Header\n  if (location.origin === \"null\") dom.websiteUrl.textContent = location.pathname\n  else dom.websiteUrl.textContent = location.origin + location.pathname\n  dom.query.textContent = location.search\n  dom.header.onclick = () => copyContent(dom.header)\n\n  // Robot tamper\n  require(\"./tamper\")\n\n  // SEP-0007\n  if (cosmicLib.sep7Utils.isWebHandlerSupported()) {\n    html.show(dom.registerSep7Handler)\n    dom.registerSep7Handler.onclick = () => {\n      cosmicLib.sep7Utils.registerWebHandler(\n        location.href.split(/[?#]/, 1)[0],\n        \"Cosmic.link\"\n      )\n    }\n  }\n}\n\n// Signing interface\nconst signingUI = require(\"./signing-ui\")\nconst signingPage = Page.add(\"Sign\", dom.sign)\nsigningPage.onSelect = function () {\n  history.replaceState(\"\", null, location.pathname + location.search)\n  signingUI.refresh()\n}\n\nsigningUI.init()\n\n// About page\nif (!the.contextIsWidget) Page.add(\"Help\", dom.help)\n\n// Default page\nif (Page.current === signingPage) signingPage.onSelect()\nelse if (!Page.current) Page.select(\"#sign\")\n","\"use_strict\"\n/**\n * Generic helpers\n */\nconst helpers = exports\n\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\n\n/*******************************************************************************\n * Form Elements Helpers\n */\n\nhelpers.enableButton = function (button, value, onclick) {\n  if (typeof value === \"string\") button.value = value\n  button.onclick = onclick\n  button.disabled = false\n}\n\nhelpers.disableButton = function (button, value) {\n  if (typeof value === \"string\") button.value = value\n  button.disabled = true\n}\n\nhelpers.readWriteBox = function (box, placeholder, value) {\n  if (typeof value === \"string\") box.value = value\n  if (typeof placeholder === \"string\") box.placeholder = placeholder\n  box.disabled = false\n  box.readOnly = false\n  box.onclick = undefined\n  box.style.cursor = \"initial\"\n}\n\nhelpers.readOnlyBox = function (box, value) {\n  if (typeof value === \"string\") box.value = value\n  box.disabled = false\n  box.readOnly = true\n  box.onclick = () => helpers.copyContent(box)\n  box.style.cursor = \"pointer\"\n}\n\nhelpers.disableBox = function (box, placeholder) {\n  helpers.readWriteBox(box, placeholder, \"\")\n  box.disabled = true\n}\n\n/*******************************************************************************\n * Other Helpers\n */\n\nhelpers.display = function (element, type = \"\", message = \"\") {\n  const classname = type ? \".\" + type : null\n  const messageNode = classname\n    ? html.create(\"span\", classname, message)\n    : message\n  html.rewrite(element, html.create(\"span\", classname, messageNode))\n}\n\nhelpers.showIf = function (flag, element) {\n  flag ? html.show(element) : html.hide(element)\n}\n\nhelpers.switchPage = function (from, to) {\n  html.append(dom.body, from)\n  html.append(dom.main, to)\n}\n\nhelpers.copyContent = function (element) {\n  if (html.copyContent(element) && document.activeElement.value) {\n    const prevNode = html.grab(\"#copied\")\n    if (prevNode) html.destroy(prevNode)\n    const copiedNode = html.create(\"span\", \"#copied\", \"Copied\")\n    element.parentNode.insertBefore(copiedNode, element)\n    setTimeout(() => {\n      copiedNode.hidden = true\n    }, 3000)\n  }\n}\n"],"sourceRoot":""}